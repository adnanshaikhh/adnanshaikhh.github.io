<!DOCTYPE html>
<html>
  <head>
  <!-- Main/Important Meta -->
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A Hacky GPU Switcher &#8226; Adnan Shaikh</title>

  <!-- Icons -->
  <link rel="apple-touch-icon" href="/images/me.jpg"/>
  <link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64" href="/favicon.ico" />

  <!-- Styles -->
  
  <style type="text/css">#navigation{text-align:center}#navigation a{margin:1em;display:inline-block}div.site-content{margin-left:auto;margin-right:auto;margin-top:40px;padding-left:10px;padding-right:10px}@font-face{font-family:Vollkorn;font-style:normal;src:url(/assets/fonts/Vollkorn-Regular.otf);font-display:fallback}body{font-family:'Vollkorn', serif;font-feature-settings:'lnum';color:#112;background-color:#fffff8;font-size:17.8px}p,li{font-size:1.3em;font-size:17.8px}ul,ol{margin-block-start:0em;margin-block-end:0em}p{margin-block-start:0.25em;margin-block-end:0.25em}header,main{padding:0 20px}.wrapper{margin-top:10%}a:link,a:visited,a:hover,a:active{color:#b58900;text-decoration:none}a:hover{text-decoration:underline}.shadow-img{box-shadow:0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}h2,h3{margin-block-start:0.50em;margin-block-end:0.25em}h4{margin-block-start:1.5em;margin-block-end:-0.8em}.main-list-item{font-weight:bold;font-size:1.2em;margin:0.8em 0}.fa-ul.main-list{margin-left:0}.main-list-item-icon{width:36px;color:#112}.logo-container{text-align:center}.logo{width:96px;height:96px;display:inline-block;background-size:cover;border-radius:50%;-moz-border-radius:50%;border:2px solid #fffff8;box-shadow:0 0 0 3px #112}.author-container h1{font-size:2.8em;margin-top:0;margin-bottom:0;text-align:center}.tagline-container p{font-size:1.3em;text-align:center;margin-bottom:2em}hr{border:0;height:1px;background-image:-webkit-linear-gradient(left, rgba(0,0,0,0), #112, rgba(0,0,0,0));background-image:-moz-linear-gradient(left, rgba(0,0,0,0), #112, rgba(0,0,0,0));background-image:-ms-linear-gradient(left, rgba(0,0,0,0), #112, rgba(0,0,0,0));background-image:-o-linear-gradient(left, rgba(0,0,0,0), #112, rgba(0,0,0,0))}footer{position:fixed;bottom:0;right:0;height:20px}.poweredby{font-family:"Arial Narrow", Arial;font-size:0.6em;line-height:0.6em;padding:0 5px;margin-top:30px;text-align:center}@media (min-width: 480px){.wrapper{width:480px;margin:2.5% auto 0 auto}div.site-content{width:480px}}@media (min-width: 768px){.wrapper{width:680px}div.site-content{width:680px}header{float:left;width:30%;text-align:right}.author-container h1,.logo-container,.tagline-container p{text-align:right}main{width:62%;margin-left:43%;padding:0}}@media (max-width: 768px){header ul span.fa{float:left;padding-top:3px}}.social{text-align:center}.social li{display:inline-block;font-size:1px;padding-left:20px}#reddit-share{padding-left:0px}blockquote{background:#f9f9f9;border-left:10px solid #ccc;margin:1.5em 10px;padding:0.5em 10px;quotes:"“" "”" "‘" "’"}blockquote p{display:inline}table{border:collapse}th,td{padding:5px}table,th,td{border:1px solid #112}
</style>
  <link rel="preload" href="/assets/solarized.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/assets/solarized.css"></noscript>
  <link rel="preload" as="font" type="font/woff2" crossorigin href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/fonts/fontawesome-webfont.woff2?v=4.3.0"/>
  <link rel="preload" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"></noscript>
  <link rel="canonical" href="/2019/11/30/a-hacky-gpu-switcher/">

  <!-- Meta information -->
  <meta name="author" content="Adnan Shaikh">
  <meta name="description" content="Adnan Shaikh's personal website and blog."/>
  <meta name="keywords" content="blog programming student resume technology talks">

  <!-- Open Graph tags (Facebook meta-info) -->
  <meta property="og:title" content="A Hacky GPU Switcher - Adnan Shaikh"/>
  <meta property="og:url" content="adnanshaikh.com/2019/11/30/a-hacky-gpu-switcher/"/>
  <meta property="og:image" content="adnanshaikh.com/images/me.jpg"/>
  <meta property="og:description" content="Should've gone with NVIDIA"/>
  <meta property="og:site_name" content="Adnan Shaikh's Blog"/>
  <meta property="og:see_also" content="adnanshaikh.com"/>

  <!-- Various Javascript -->
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-88085331-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-88085331-1');
</script>
</head>

  <body>
  <div id="navigation" class="clearfix">
    <a href="/">home/</a>
    <a href="/blog">blog/</a>
    <a href="/resume">resume/</a>
    <a href="/now">now/</a>
    <a href="/impossible">impossible/</a>
    <a href="/kb">kb/</a>
  </div>

  <div class="site-content">
    <h1>A Hacky GPU Switcher</h1>
<em>Adnan Shaikh &bull; 30 November 2019</em>

<p>With the arrival of my Razer Core X eGPU enclosure, I was pretty excited to get
back into some video editing and gaming, but there was a massive issue. My video
and audio streams were both stuttering as soon as I’d plug it in. A bit of
googling led to me to the solution to disable my integrated GPU from the Device
Manager. That was odd though, I didn’t see any complaints from users with
dedicated NVIDIA GPUs in their machines. I figure NVIDIA Optimus must have
something to do with this. Anyway, with a working solution I could finally begin
automating this procedure.</p>

<p>Windows provides a pretty powerful interface to instrument your plugged in
hardware through WMI – Windows Management Interface. Here’s the powershell
script I wrote that’s spawned everytime Windows boots up. It’s pretty neat since
it works on events and not constant polling, so it’s pretty efficient too.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check to see if we are currently running "as Administrator"</span><span class="w">
</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nf">Verify-Elevated</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nf">Start-Process</span><span class="w"> </span><span class="nx">powershell</span><span class="w"> </span><span class="nt">-Verb</span><span class="w"> </span><span class="nx">runAs</span><span class="w"> </span><span class="nt">-ArgumentList</span><span class="w"> </span><span class="p">@(</span><span class="s2">"-NoExit"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-Command </span><span class="se">`"</span><span class="s2">cd </span><span class="se">`'</span><span class="si">$(</span><span class="p">([</span><span class="kt">string</span><span class="p">](</span><span class="nf">Get-Location</span><span class="p">)</span><span class="si">)</span><span class="s2">.TrimEnd('\'))</span><span class="se">`'</span><span class="s2">; </span><span class="si">$(</span><span class="nv">$myInvocation</span><span class="o">.</span><span class="nf">MyCommand</span><span class="o">.</span><span class="nf">Definition</span><span class="si">)</span><span class="se">`"</span><span class="s2">"</span><span class="p">)</span><span class="w">
    </span><span class="kr">exit</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="nf">Unregister-Event</span><span class="w"> </span><span class="nt">-SourceIdentifier</span><span class="w"> </span><span class="nx">graphicsCardChanged</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w">
</span><span class="nf">Register-WmiEvent</span><span class="w"> </span><span class="nt">-Class</span><span class="w"> </span><span class="nx">Win32_DeviceChangeEvent</span><span class="w"> </span><span class="nt">-SourceIdentifier</span><span class="w"> </span><span class="nx">graphicsCardChanged</span><span class="w">

</span><span class="c"># Get inital eGPU state</span><span class="w">
</span><span class="nv">$GPUConnected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$null</span><span class="w">
</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="bp">$null</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="p">(</span><span class="nf">Get-PnpDevice</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Where-Object</span><span class="w"> </span><span class="p">{(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">friendlyname</span><span class="p">)</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"Radeon RX 590*"</span><span class="w"> </span><span class="o">-and</span><span class="w"> </span><span class="p">(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">status</span><span class="p">)</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"Ok"</span><span class="p">}))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="c"># Write-Host("eGPU is initially connected")</span><span class="w">
    </span><span class="nv">$GPUConnected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nf">Get-PnpDevice</span><span class="o">|</span><span class="w"> </span><span class="nf">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">friendlyname</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"Intel(R) Iris(R) Plus Graphics*"</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Enable-PnpDevice</span><span class="w"> </span><span class="nt">-Confirm</span><span class="p">:</span><span class="bp">$false</span><span class="w">
    </span><span class="nv">$GPUConnected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">do</span><span class="p">{</span><span class="w">
    </span><span class="nv">$newEvent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Wait-Event</span><span class="w"> </span><span class="nt">-SourceIdentifier</span><span class="w"> </span><span class="nx">graphicsCardChanged</span><span class="w">
    </span><span class="nv">$eventType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$newEvent</span><span class="o">.</span><span class="nf">SourceEventArgs</span><span class="o">.</span><span class="nf">NewEvent</span><span class="o">.</span><span class="nf">EventType</span><span class="w">
    </span><span class="c">#Write-Host($eventType)</span><span class="w">
    
    </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$GPUConnected</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="bp">$false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nv">$isEGPUConnected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$null</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="p">(</span><span class="nf">Get-PnpDevice</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Where-Object</span><span class="w"> </span><span class="p">{(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">friendlyname</span><span class="p">)</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"Radeon RX 590*"</span><span class="w"> </span><span class="o">-and</span><span class="w"> </span><span class="p">(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">status</span><span class="p">)</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"Ok"</span><span class="p">})</span><span class="w">
        </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$eventType</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-and</span><span class="w"> </span><span class="nv">$isEGPUConnected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="c">#Event - Device Arrival</span><span class="w">
            </span><span class="c"># Write-Host("Device Arrived")</span><span class="w">
            </span><span class="nf">Get-PnpDevice</span><span class="o">|</span><span class="w"> </span><span class="nf">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">friendlyname</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"Intel(R) Iris(R) Plus Graphics*"</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Disable-PnpDevice</span><span class="w"> </span><span class="nt">-Confirm</span><span class="p">:</span><span class="bp">$false</span><span class="w">
            </span><span class="nv">$GPUConnected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$GPUConnected</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="bp">$true</span><span class="w"> </span><span class="o">-and</span><span class="w"> </span><span class="nv">$eventType</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-or</span><span class="w"> </span><span class="nv">$eventType</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="c">#Event - Device config changed</span><span class="w">
        </span><span class="c"># For some reason when I plug out the Razer Core X, it doesn't send an</span><span class="w">
        </span><span class="c"># event type 3 signal, so I'm working with config changed instead.</span><span class="w">
        </span><span class="c"># Write-Host("Device config changed")</span><span class="w">
        </span><span class="nv">$isEGPUUnknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$null</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="p">(</span><span class="nf">Get-PnpDevice</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Where-Object</span><span class="w"> </span><span class="p">{(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">friendlyname</span><span class="p">)</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"Radeon RX 590*"</span><span class="w"> </span><span class="o">-and</span><span class="w"> </span><span class="p">(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">status</span><span class="p">)</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"Unknown"</span><span class="p">})</span><span class="w">
        </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$isEGPUUnknown</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="c"># Write-Host("eGPU is Unknown")</span><span class="w">
            </span><span class="nf">Get-PnpDevice</span><span class="o">|</span><span class="w"> </span><span class="nf">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">friendlyname</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"Intel(R) Iris(R) Plus Graphics*"</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">Enable-PnpDevice</span><span class="w"> </span><span class="nt">-Confirm</span><span class="p">:</span><span class="bp">$false</span><span class="w">
            </span><span class="nv">$GPUConnected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$false</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">	
    </span><span class="nf">Remove-Event</span><span class="w"> </span><span class="nt">-SourceIdentifier</span><span class="w"> </span><span class="nx">graphicsCardChanged</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="nt">-eq1</span><span class="p">)</span><span class="w"> </span><span class="c">#Loop until next event</span><span class="w">
</span><span class="nf">Unregister-Event</span><span class="w"> </span><span class="nt">-SourceIdentifier</span><span class="w"> </span><span class="nx">graphicsCardChanged</span><span class="w">
</span></code></pre></div></div>

<p>With the main script out of the way, here’s the script to register it to spawn
upon boot with Task Scheduler.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$installGPU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Read-Host</span><span class="w"> </span><span class="s2">"Register Raden RX 590 GPU switcher task? (y/n)"</span><span class="w">

</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$installGPU</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="s1">'y'</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$taskName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"GPU switcher"</span><span class="w">
    </span><span class="nv">$userName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">UserName</span><span class="w">

    </span><span class="nv">$password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Read-Host</span><span class="w"> </span><span class="s2">"Password"</span><span class="w">

    </span><span class="nf">Unregister-ScheduledTask</span><span class="w"> </span><span class="nt">-TaskName</span><span class="w"> </span><span class="nv">$taskName</span><span class="w"> </span><span class="nt">-Confirm</span><span class="p">:</span><span class="bp">$false</span><span class="w"> </span><span class="nt">-Erroraction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w">

    </span><span class="nv">$profileDirPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Split-Path</span><span class="w"> </span><span class="nt">-parent</span><span class="w"> </span><span class="nv">$profile</span><span class="w">
    </span><span class="nv">$gpuScript</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Join-Path</span><span class="w"> </span><span class="nv">$profileDirPath</span><span class="w"> </span><span class="s2">"gpu_switcher.ps1"</span><span class="w">
    </span><span class="nv">$action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">New-ScheduledTaskAction</span><span class="w"> </span><span class="nt">-Execute</span><span class="w"> </span><span class="nx">powershell.exe</span><span class="w"> </span><span class="nt">-Argument</span><span class="w"> </span><span class="s2">"</span><span class="se">`"</span><span class="nv">$gpuScript</span><span class="se">`"</span><span class="s2">"</span><span class="w">
    </span><span class="nv">$settings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">New-ScheduledTaskSettingsSet</span><span class="w"> </span><span class="nt">-AllowStartIfOnBatteries</span><span class="w"> </span><span class="nt">-DontStopIfGoingOnBatteries</span><span class="w">

    </span><span class="nf">Register-ScheduledTask</span><span class="w"> </span><span class="nt">-Action</span><span class="w"> </span><span class="nv">$action</span><span class="w"> </span><span class="nt">-TaskName</span><span class="w"> </span><span class="nv">$taskName</span><span class="w"> </span><span class="nt">-Settings</span><span class="w"> </span><span class="nv">$settings</span><span class="w">  </span><span class="nt">-Description</span><span class="w"> </span><span class="s2">"Switches to the Radeon RX 590 eGPU when plugged in"</span><span class="w"> </span><span class="nt">-User</span><span class="w"> </span><span class="nv">$userName</span><span class="w"> </span><span class="nt">-Password</span><span class="w"> </span><span class="nv">$password</span><span class="w">

    </span><span class="c"># Now add a special trigger to it with COM API.</span><span class="w">
    </span><span class="c"># Get the service and task</span><span class="w">
    </span><span class="nv">$ts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">New-Object</span><span class="w"> </span><span class="nt">-ComObject</span><span class="w"> </span><span class="nx">Schedule.Service</span><span class="w">
    </span><span class="nv">$ts</span><span class="o">.</span><span class="nf">Connect</span><span class="p">()</span><span class="w">
    </span><span class="nv">$task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$ts</span><span class="o">.</span><span class="nf">GetFolder</span><span class="p">(</span><span class="s2">"\"</span><span class="p">)</span><span class="o">.</span><span class="nf">GetTask</span><span class="p">(</span><span class="nv">$taskName</span><span class="p">)</span><span class="o">.</span><span class="nf">Definition</span><span class="w">

    </span><span class="c"># Create the trigger</span><span class="w">
    </span><span class="nv">$TRIGGER_TYPE_STARTUP</span><span class="o">=</span><span class="mi">8</span><span class="w">
    </span><span class="nv">$startTrigger</span><span class="o">=</span><span class="nv">$task</span><span class="o">.</span><span class="nf">Triggers</span><span class="o">.</span><span class="nf">Create</span><span class="p">(</span><span class="nv">$TRIGGER_TYPE_STARTUP</span><span class="p">)</span><span class="w">
    </span><span class="nv">$startTrigger</span><span class="o">.</span><span class="nf">Enabled</span><span class="o">=</span><span class="bp">$true</span><span class="w">
    </span><span class="nv">$startTrigger</span><span class="o">.</span><span class="nf">Id</span><span class="o">=</span><span class="s2">"StartupTrigger"</span><span class="w">

    </span><span class="c"># Re-save the task in place.</span><span class="w">
    </span><span class="nv">$TASK_CREATE_OR_UPDATE</span><span class="o">=</span><span class="mi">6</span><span class="w">
    </span><span class="nv">$TASK_LOGIN_PASSWORD</span><span class="o">=</span><span class="mi">1</span><span class="w">
    </span><span class="nv">$ts</span><span class="o">.</span><span class="nf">GetFolder</span><span class="p">(</span><span class="s2">"\"</span><span class="p">)</span><span class="o">.</span><span class="nf">RegisterTaskDefinition</span><span class="p">(</span><span class="nv">$taskName</span><span class="p">,</span><span class="w"> </span><span class="nv">$task</span><span class="p">,</span><span class="w"> </span><span class="nv">$TASK_CREATE_OR_UPDATE</span><span class="p">,</span><span class="w"> </span><span class="nv">$userName</span><span class="p">,</span><span class="w"> </span><span class="nv">$password</span><span class="p">,</span><span class="w"> </span><span class="nv">$TASK_LOGIN_PASSWORD</span><span class="p">)</span><span class="w">

    </span><span class="nf">Start-ScheduledTask</span><span class="w"> </span><span class="nt">-TaskName</span><span class="w"> </span><span class="nv">$taskName</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>


<div class="social">
  <ul>
  </ul>
</div>
<hr>



</div>


  <div style="clear:both;"></div>
  <div class="poweredby">
      <!-- <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Made with <3</span></a> -->
  </div>
  </body>
</html>
